<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/common :: head('Leaderboard')}">
    <title>Leaderboard</title>
</head>
<body>

<link rel="stylesheet" th:href="@{/css/leaderboard.css}">

<div th:replace="~{fragments/common :: blobs}"></div>

<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4" style="position: relative; z-index: 2;">
        <a href="/" class="btn-modern header-btn">
            <span style="font-size: 1.2rem; line-height: 1;">‚Üê</span>
            <span class="d-none d-sm-inline ms-2">Menu</span> </a>

        <h2 class="fw-bold m-0 text-center fs-4 fs-sm-2"
            style="background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            Hall of Fame
        </h2>

        <button class="btn-modern theme-toggle-header header-btn" onclick="toggleTheme()" id="themeBtn">‚òÄÔ∏è</button>
    </div>

    <div class="leader-card">
        <ul class="nav nav-pills" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation" th:each="cat : ${categories}">
                <button class="nav-link" th:classappend="${cat == 'ALL'} ? 'active' : ''"
                        th:id="'pills-' + ${cat} + '-tab'" data-bs-toggle="pill"
                        th:data-bs-target="'#pills-' + ${cat}" type="button" role="tab"
                        th:text="${cat == 'ALL' ? 'üî• Hardcore' : 'Section ' + cat}">
                </button>
            </li>
        </ul>

        <div class="tab-content" id="pills-tabContent">
            <div th:each="cat : ${categories}" class="tab-pane fade"
                 th:classappend="${cat == 'ALL'} ? 'show active' : ''"
                 th:id="'pills-' + ${cat}" role="tabpanel"
                 th:with="list=${leaderboards.get(cat)}">

                <div th:if="${list == null || list.isEmpty()}" class="text-center py-5">
                    <div style="font-size: 3rem; opacity: 0.5;">üöÄ</div>
                    <h4 class="mt-3">No Records Yet</h4>
                    <p style="color: var(--text-muted)">Be the first!</p>
                </div>

                <div th:unless="${list == null || list.isEmpty()}">

                    <div class="podium-container" th:if="${list.size() > 0}">
                        <div class="podium-item rank-2" th:if="${list.size() >= 2}">
                            <img th:src="'https://api.dicebear.com/7.x/notionists/svg?seed=' + ${list[1].name}" class="avatar-podium">
                            <div class="podium-base">2</div>
                            <div class="podium-name" th:text="${list[1].name}">User</div>
                            <div class="podium-score" th:text="${list[1].score} + ' pts'"></div>
                        </div>

                        <div class="podium-item rank-1">
                            <img th:src="'https://api.dicebear.com/7.x/notionists/svg?seed=' + ${list[0].name}" class="avatar-podium">
                            <div class="podium-base">1</div>
                            <div class="podium-name" th:text="${list[0].name}">User</div>
                            <div class="podium-score" th:text="${list[0].score} + ' pts'"></div>
                        </div>

                        <div class="podium-item rank-3" th:if="${list.size() >= 3}">
                            <img th:src="'https://api.dicebear.com/7.x/notionists/svg?seed=' + ${list[2].name}" class="avatar-podium">
                            <div class="podium-base">3</div>
                            <div class="podium-name" th:text="${list[2].name}">User</div>
                            <div class="podium-score" th:text="${list[2].score} + ' pts'"></div>
                        </div>
                    </div>

                    <table>
                        <thead><tr><th width="15%">Rank</th><th width="45%">Player</th><th width="20%">Score</th><th width="20%">Time</th></tr></thead>
                        <tbody>
                        <tr th:each="score, stat : ${list}"
                            th:classappend="${highlight != null and score.name == highlight} ? 'highlight-row' : ''">
                            <td>
                                <span th:if="${stat.count == 1}" class="fw-bold rank-gold">ü•á 1</span>
                                <span th:if="${stat.count == 2}" class="fw-bold rank-silver">ü•à 2</span>
                                <span th:if="${stat.count == 3}" class="fw-bold rank-bronze">ü•â 3</span>
                                <span th:if="${stat.count > 3}" style="color: var(--text-muted); padding-left: 24px;" th:text="${stat.count}"></span>
                            </td>
                            <td>
                                <div class="d-flex align-items-center">
                                    <img th:src="'https://api.dicebear.com/7.x/notionists/svg?seed=' + ${score.name}" class="avatar-img">
                                    <span class="fw-bold" th:text="${score.name}">User</span>
                                </div>
                            </td>
                            <td><span class="score-badge" th:text="${score.score}">0</span></td>
                            <td style="font-family: 'JetBrains Mono'; color: var(--text-muted);" th:text="${score.timeFormatted}">00:00</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script th:replace="~{fragments/common :: scripts}"></script>
</body>
</html>